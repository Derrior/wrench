<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.6"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <title>WRENCH: File Registry</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <script type="text/javascript" src="jquery.smartmenus.js"></script>
    <!-- SmartMenus jQuery Bootstrap Addon -->
    <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
    <!-- SmartMenus jQuery plugin -->
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="http://wrench-project.org" class="navbar-brand">
                <img alt="Logo" src="logo-horizontal.png" width="160" style="float: left"/>
                1.3
            </a>
        </div>
        <div id="main-nav" class="nav navbar-nav navbar-right">
            <ul class="sm sm-dox nav navbar-nav navbar-right" id="main-menu">
                <li><a href="index.html">Overview</a></li>
                <li><a href="install.html">Installation</a></li>
                <li><a href="getting-started.html">Getting Started</a></li>
                <li><a href="wrench-101.html">WRENCH 101</a></li>
                <li><a href="guide.html">Guide</a></li>
                <li><a href="annotated.html">API Reference</a></li>
                <li style="float: right">
                    <input type="hidden" id="MSearchField">
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">File Registry </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#guide-fileregistry-overview">Overview</a></li>
<li class="level1"><a href="#guide-fileregistry-creating">Creating a file registry service</a><ul><li class="level2"><a href="#guide-fileregistry-creating-properties">File registry service properties</a></li>
</ul>
</li>
<li class="level1"><a href="#guide-fileregistry-using">Using a file registry service</a></li>
</ul>
</div>
<div class="textblock"><div class="doc-type">Internal Documentation</div><div class="doc-link">Other: <a href="../user/guide-fileregistry.html">User</a> - <a href="../developer/guide-fileregistry.html">Developer</a></div><h1><a class="anchor" id="guide-fileregistry-overview"></a>
Overview</h1>
<p>A file registry service is a simple store of key-value pairs where keys are files (i.e., <code><a class="el" href="classwrench_1_1_workflow_file.html" title="A data file used/produced by a WorkflowTask in a Workflow. ">wrench::WorkflowFile</a></code>) and values are Storage Services (i.e., <code><a class="el" href="classwrench_1_1_storage_service.html" title="The storage service base class. ">wrench::StorageService</a></code>). It is used to keep track of the location of file copies. In real-world deployments, this service is often called a "replica catalog".</p>
<h1><a class="anchor" id="guide-fileregistry-creating"></a>
Creating a file registry service</h1>
<p>In WRENCH, a file registry service is defined by the <code><a class="el" href="classwrench_1_1_file_registry_service.html" title="A file registry service (a.k.a. replica catalog) that holds a database of which files are available a...">wrench::FileRegistryService</a></code> class, an instantiation of which requires the following parameters:</p>
<ul>
<li>The name of a host on which to start the service (this is the entry point to the service);</li>
<li>Maps (<code>std::map</code>) of configurable properties (<code><a class="el" href="classwrench_1_1_network_proximity_service_property.html" title="Configurable properties for a NetworkProximityService. ">wrench::NetworkProximityServiceProperty</a></code>) and configurable message payloads (<code><a class="el" href="classwrench_1_1_network_proximity_service_message_payload.html" title="Configurable message payloads for a NetworkProximityService. ">wrench::NetworkProximityServiceMessagePayload</a></code>).</li>
</ul>
<p>The example below shows how to create an instance that runs on host "ReplicaCatalog". The service's properties are customized to specify that it takes 0.1 (simulated) seconds for the service to lookup an entry in its database.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> fr_service = simulation-&gt;<a class="code" href="classwrench_1_1_simulation.html#ad1f5c12285ecfaf5a2ce7dab5ec8b4c5">add</a>(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="classwrench_1_1_file_registry_service.html">wrench::FileRegistryService</a>(<span class="stringliteral">&quot;ReplicaCatalog&quot;</span>,</div>
<div class="line">                                       {{wrench::FileRegistryService::LOOKUP_COMPUTE_COST, <span class="stringliteral">&quot;0.1&quot;</span>}},</div>
<div class="line">                                       {});</div>
</div><!-- fragment --><h2><a class="anchor" id="guide-fileregistry-creating-properties"></a>
File registry service properties</h2>
<p>The properties that can be configured for a file registry service include:</p>
<ul>
<li><code>wrench::FileRegistryService::LOOKUP_COMPUTE_COST</code></li>
</ul>
<h1><a class="anchor" id="guide-fileregistry-using"></a>
Using a file registry service</h1>
<p>Adding/removing an entry to a file registry service is done as follows:</p>
<div class="fragment"><div class="line"><a class="code" href="classwrench_1_1_workflow_file.html">wrench::WorkflowFile</a> *some_file;</div>
<div class="line"><a class="code" href="classwrench_1_1_storage_service.html">wrench::StorageService</a> *some_storage_service;</div>
<div class="line"></div>
<div class="line">[...]</div>
<div class="line"></div>
<div class="line">fr_service-&gt;addEntry(some_file, some_storage_service);</div>
<div class="line">fr_service-&gt;removeEntry(some_file, some_storage_service);</div>
</div><!-- fragment --><p>Retrieving all entries for a given file is done as follows:</p>
<div class="fragment"><div class="line"><a class="code" href="classwrench_1_1_workflow_file.html">wrench::WorkflowFile</a> *some_file;</div>
<div class="line"></div>
<div class="line">[...]</div>
<div class="line"></div>
<div class="line">std::set&lt;wrench::StorageService *&gt; entries;</div>
<div class="line">entries = fr_service-&gt;lookupEntry(some_file);</div>
</div><!-- fragment --><p>If a <a class="el" href="guide-networkproximity.html">network proximity service</a> is running, it is possible to retrieve entries for a file sorted by non-decreasing proximity from some reference host. Returned entries are stored in a (sorted) <code>std::map</code> where the keys are network distances to the reference host. For instance:</p>
<div class="fragment"><div class="line"><a class="code" href="classwrench_1_1_workflow_file.html">wrench::WorkflowFile</a> *some_file;</div>
<div class="line"><a class="code" href="classwrench_1_1_network_proximity_service.html">wrench::NetworkProximityService</a> *np_service;</div>
<div class="line"></div>
<div class="line">[...]</div>
<div class="line">std::map&lt;double, wrench::StorageService *&gt; entries;</div>
<div class="line">entries = fr_service-&gt;lookupEntry(some_file, <span class="stringliteral">&quot;ReferenceHost&quot;</span>, np_service);</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/>
<address class="footer">
    <small>
        Generated by &#160;<a href="http://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.png" alt="doxygen"/>
    </a> 1.8.6
    </small>
</address>
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-18066333-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
<script type="text/javascript" src="doxy-boot.js"></script>
</html>
