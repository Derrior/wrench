<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <title>WRENCH: Virtualized Cluster</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <script type="text/javascript" src="jquery.smartmenus.js"></script>
    <!-- SmartMenus jQuery Bootstrap Addon -->
    <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
    <!-- SmartMenus jQuery plugin -->
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="http://wrench-project.org" class="navbar-brand">
                <img alt="Logo" src="logo-horizontal.png" width="160" style="float: left"/>
                1.4
            </a>
        </div>
        <div id="main-nav" class="nav navbar-nav navbar-right">
            <ul class="sm sm-dox nav navbar-nav navbar-right" id="main-menu">
                <li><a href="index.html">Overview</a></li>
                <li><a href="install.html">Installation</a></li>
                <li><a href="getting-started.html">Getting Started</a></li>
                <li><a href="wrench-101.html">WRENCH 101</a></li>
                <li><a href="guide.html">Guide</a></li>
                <li><a href="annotated.html">API Reference</a></li>
                <li style="float: right">
                    <input type="hidden" id="MSearchField">
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Virtualized Cluster </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#guide-virtualizedcluster-overview">Overview</a></li>
<li class="level1"><a href="#guide-virtualizedcluster-creating">Creating a virtualized cluster compute service</a><ul><li class="level2"><a href="#guide-virtualizedcluster-creating-properties">Virtualized cluster service properties</a></li>
</ul>
</li>
<li class="level1"><a href="#guide-virtualizedcluster-migrating">Migrating a VM to another execution host</a></li>
<li class="level1"><a href="#guide-virtualizedcluster-using">Submitting jobs to a virtualized cluster compute service</a></li>
</ul>
</div>
<div class="textblock"><div class="doc-type">Developer Documentation</div><div class="doc-link">Other: <a href="../user/guide-virtualizedcluster.html">User</a> - <a href="../internal/guide-virtualizedcluster.html">Internal</a></div><h1><a class="anchor" id="guide-virtualizedcluster-overview"></a>
Overview</h1>
<p>A virtualized cluster service is an abstraction of a compute service that corresponds to a platform of physical resources on which Virtual Machine (VM) instances can be created. The virtualized cluster service provides all necessary abstractions to manage VMs and their allocation to physical resources, including creation on specific physical hosts, suspend/resume, migration, etc. Compute jobs submitted to the virtualized cluster service run on previously created VM instances. If a VM that meets a job's requirements cannot be found, the service will throw an exception. In the virtualized cluster service, a VM behaves as a <a class="el" href="guide-baremetal.html">bare-metal</a> service.</p>
<p>The main difference between a <a class="el" href="guide-cloud.html">cloud service</a> and a virtualized cluster service is that the latter does expose the underlying physical infrastructure (e.g., it is possible to instantiate a VM on a particular physical host, or to migrate a VM between two particular physical hosts).</p>
<h1><a class="anchor" id="guide-virtualizedcluster-creating"></a>
Creating a virtualized cluster compute service</h1>
<p>In WRENCH, a virtualized cluster service represents a cloud service (<a class="el" href="classwrench_1_1_cloud_service.html" title="A cloud-based compute service that manages a set of physical hosts and controls access to their resou...">wrench::CloudService</a>, which itself represents a <a class="el" href="classwrench_1_1_compute_service.html" title="The compute service base class. ">wrench::ComputeService</a>), which is defined by the <a class="el" href="classwrench_1_1_virtualized_cluster_service.html" title="A virtualized cluster-based compute service. ">wrench::VirtualizedClusterService</a> class. An instantiation of a virtualized cluster service requires the following parameters:</p>
<ul>
<li>A hostname on which to start the service (this is the entry point to the service)</li>
<li>A list (<code>std::vector</code>) of hostnames (all cores and all RAM of each host is available to the virtualized cluster service)</li>
<li>A scratch space size, i.e., the size in bytes of storage local to the virtualized cluster service (used to store workflow files, as needed, during job executions)</li>
<li>Maps (<code>std::map</code>) of configurable properties (<code><a class="el" href="classwrench_1_1_virtualized_cluster_service_property.html" title="Configurable properties for a VirtualizedClusterService. ">wrench::VirtualizedClusterServiceProperty</a></code>) and configurable message payloads (<code><a class="el" href="classwrench_1_1_virtualized_cluster_service_message_payload.html" title="Configurable message payloads for a VirtualizedClusterService. ">wrench::VirtualizedClusterServiceMessagePayload</a></code>).</li>
</ul>
<p>The example below shows how to create an instance of a virtualized cluster service that runs on host "vc_gateway", provides access to 4 execution hosts, and has a scratch space of 1TiB:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> virtualized_cluster_cs = simulation.add(</div><div class="line">          <span class="keyword">new</span> <a class="code" href="classwrench_1_1_virtualized_cluster_service.html">wrench::VirtualizedClusterService</a>(<span class="stringliteral">&quot;vc_gateway&quot;</span>, {<span class="stringliteral">&quot;host1&quot;</span>, <span class="stringliteral">&quot;host2&quot;</span>, <span class="stringliteral">&quot;host3&quot;</span>, <span class="stringliteral">&quot;host4&quot;</span>}, pow(2,40),</div><div class="line">                                                {{<a class="code" href="classwrench_1_1_compute_service_property.html#af0abab1e3bce4932c4482031f0c31ce8">wrench::VirtualizedClusterServiceProperty::SUPPORTS_PILOT_JOBS</a>, <span class="stringliteral">&quot;false&quot;</span>}}));</div></div><!-- fragment --><h2><a class="anchor" id="guide-virtualizedcluster-creating-properties"></a>
Virtualized cluster service properties</h2>
<p>All properties for a virtualized cluster service are inherited from <code><a class="el" href="classwrench_1_1_cloud_service_property.html" title="Configurable properties for a CloudService. ">wrench::CloudServiceProperty</a></code> (see the <a class="el" href="guide-cloud.html#guide-cloud-creating-properties">Cloud service properties</a> section).</p>
<h1><a class="anchor" id="guide-virtualizedcluster-migrating"></a>
Migrating a VM to another execution host</h1>
<p>As expected, a virtualized cluster service provides access to all mechanisms to <a class="el" href="guide-cloud.html#guide-cloud-managing">manage</a> the set of VMs instantiated on the execution hosts. In addition to such capabilities, the virtualized cluster service provides an additional <a class="el" href="classwrench_1_1_virtualized_cluster_service.html#afb90d549ca85f41946b155cff49e37ce" title="Create a BareMetalComputeService VM on a physical machine. ">wrench::VirtualizedClusterService::createVM</a> function, which instantiates a VM on a specific execution host; and a <a class="el" href="classwrench_1_1_virtualized_cluster_service.html#a0a81357e7af9b42bbb7b376c56a90611" title="Synchronously migrate a VM to another physical host. ">wrench::VirtualizedClusterService::migrateVM</a> function, which allows VM migration between execution hosts.</p>
<p>Here is an example of VMs migration on a virtualized cluster service:</p>
<div class="fragment"><div class="line"><span class="comment">// Create a VM with 2 cores and 1 GiB of RAM on host1</span></div><div class="line"><span class="keyword">auto</span> vm1 = virtualized_cluster_cs-&gt;createVM(<span class="stringliteral">&quot;host1&quot;</span>, 2, pow(2,30));</div><div class="line"><span class="comment">// Create a VM with 4 cores and 2 GiB of RAM on host2</span></div><div class="line"><span class="keyword">auto</span> vm2 = virtualized_cluster_cs-&gt;createVM(<span class="stringliteral">&quot;host2&quot;</span>, 4, pow(2,31));</div><div class="line"></div><div class="line"><span class="comment">// Migrating vm1 to host3</span></div><div class="line">virtualized_cluster_cs-&gt;migrateVM(vm1, <span class="stringliteral">&quot;host3&quot;</span>);</div><div class="line"><span class="comment">// Migrating vm2 to host4</span></div><div class="line">virtualized_cluster_cs-&gt;migrateVM(vm2, <span class="stringliteral">&quot;host4&quot;</span>);</div></div><!-- fragment --><h1><a class="anchor" id="guide-virtualizedcluster-using"></a>
Submitting jobs to a virtualized cluster compute service</h1>
<p>See the <a class="el" href="guide-cloud.html">cloud service</a> page for an example of how to submit a job to a VM instance (as both the cloud service and virtualized cluster service operate in the same way). </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/>
<address class="footer">
    <small>
        Generated by &#160;<a href="http://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.png" alt="doxygen"/>
    </a> 1.8.11
    </small>
</address>
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-18066333-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
<script type="text/javascript" src="doxy-boot.js"></script>
</html>
