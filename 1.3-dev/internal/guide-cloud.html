<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <title>WRENCH: Cloud</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <script type="text/javascript" src="jquery.smartmenus.js"></script>
    <!-- SmartMenus jQuery Bootstrap Addon -->
    <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
    <!-- SmartMenus jQuery plugin -->
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="http://wrench-project.org" class="navbar-brand">
                <img alt="Logo" src="logo-horizontal.png" width="160" style="float: left"/>
                1.3-dev
            </a>
        </div>
        <div id="main-nav" class="nav navbar-nav navbar-right">
            <ul class="sm sm-dox nav navbar-nav navbar-right" id="main-menu">
                <li><a href="index.html">Overview</a></li>
                <li><a href="install.html">Installation</a></li>
                <li><a href="getting-started.html">Getting Started</a></li>
                <li><a href="wrench-101.html">WRENCH 101</a></li>
                <li><a href="guide.html">Guide</a></li>
                <li><a href="annotated.html">API Reference</a></li>
                <li style="float: right">
                    <input type="hidden" id="MSearchField">
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Cloud </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#guide-cloud-overview">Overview</a></li>
<li class="level1"><a href="#guide-cloud-creating">Creating a cloud compute service</a><ul><li class="level2"><a href="#guide-cloud-creating-properties">Cloud service properties</a></li>
</ul>
</li>
<li class="level1"><a href="#guide-cloud-managing">Managing a cloud compute service</a></li>
<li class="level1"><a href="#guide-cloud-using">Submitting Jobs to a cloud compute service</a></li>
</ul>
</div>
<div class="textblock"><div class="doc-type">Internal Documentation</div><div class="doc-link">Other: <a href="../user/guide-cloud.html">User</a> - <a href="../developer/guide-cloud.html">Developer</a></div><h1><a class="anchor" id="guide-cloud-overview"></a>
Overview</h1>
<p>A cloud service is an abstraction of a compute service that corresponds to a cloud platform that provides access to virtualized compute resources, i.e., virtual machines (VMs). The cloud service provides all necessary abstractions to manage VMs, including creation, suspension, resume, etc. Compute jobs submitted to the cloud service run on previously created VM instances. If a VM that meets a job's requirements cannot be found, the service will throw an exception. In the cloud service, a VM instance behaves as a <a class="el" href="guide-baremetal.html">bare-metal</a> service.</p>
<p>The main difference between a cloud service and a <a class="el" href="guide-virtualizedcluster.html">virtualized cluster service</a> is that the latter does expose the underlying physical infrastructure (e.g., it is possible to instantiate a VM on a particular physical host, or to migrate a VM between two particular physical hosts).</p>
<h1><a class="anchor" id="guide-cloud-creating"></a>
Creating a cloud compute service</h1>
<p>In WRENCH, a cloud service represents a compute service (<a class="el" href="classwrench_1_1_compute_service.html" title="The compute service base class. ">wrench::ComputeService</a>), which is defined by the <a class="el" href="classwrench_1_1_cloud_service.html" title="A cloud-based compute service that manages a set of physical hosts and controls access to their resou...">wrench::CloudService</a> class. An instantiation of a cloud service requires the following parameters:</p>
<ul>
<li>A hostname on which to start the service (this is the entry point to the service)</li>
<li>A list (<code>std::vector</code>) of hostnames (all cores and all RAM of each host is available to the cloud service)</li>
<li>A scratch space size, i.e., the size in bytes of storage local to the cloud service (used to store workflow files, as needed, during job executions)</li>
<li>Maps (<code>std::map</code>) of configurable properties (<code><a class="el" href="classwrench_1_1_cloud_service_property.html" title="Configurable properties for a CloudService. ">wrench::CloudServiceProperty</a></code>) and configurable message payloads (<code><a class="el" href="classwrench_1_1_cloud_service_message_payload.html" title="Configurable message payloads for a CloudService. ">wrench::CloudServiceMessagePayload</a></code>).</li>
</ul>
<p>The example below shows how to create an instance of a cloud service that runs on host "cloud_gateway", provides access to 4 execution hosts, and has a scratch space of 1TiB:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> cloud_cs = simulation.add(</div><div class="line">          <span class="keyword">new</span> <a class="code" href="classwrench_1_1_cloud_service.html">wrench::CloudService</a>(<span class="stringliteral">&quot;cloud_gateway&quot;</span>, {<span class="stringliteral">&quot;host1&quot;</span>, <span class="stringliteral">&quot;host2&quot;</span>, <span class="stringliteral">&quot;host3&quot;</span>, <span class="stringliteral">&quot;host4&quot;</span>}, pow(2,40),</div><div class="line">                                   {{<a class="code" href="classwrench_1_1_compute_service_property.html#af0abab1e3bce4932c4482031f0c31ce8">wrench::CloudServiceProperty::SUPPORTS_PILOT_JOBS</a>, <span class="stringliteral">&quot;false&quot;</span>}}));</div></div><!-- fragment --><h2><a class="anchor" id="guide-cloud-creating-properties"></a>
Cloud service properties</h2>
<p>In addition to properties inherited from <code><a class="el" href="classwrench_1_1_compute_service_property.html" title="Configurable properties for a ComputeService. ">wrench::ComputeServiceProperty</a></code>, a cloud service supports the following properties:</p>
<ul>
<li><code><a class="el" href="classwrench_1_1_cloud_service_property.html#a7e2fddc7f539dedff89fb41635a5b200" title="The overhead, in seconds, to boot a VM. ">wrench::CloudServiceProperty::VM_BOOT_OVERHEAD_IN_SECONDS</a></code></li>
</ul>
<h1><a class="anchor" id="guide-cloud-managing"></a>
Managing a cloud compute service</h1>
<p>The cloud service provides several mechanisms to manage the set of VMs instantiated on the execution hosts. Currently, it is possible to create, shutdown, start, suspend, and resume VMs (see a complete list of functions available in the <a class="el" href="classwrench_1_1_cloud_service.html" title="A cloud-based compute service that manages a set of physical hosts and controls access to their resou...">wrench::CloudService</a> API documentation). The figure below shows the different states a VM can be:</p>
<div class="image">
<img src="wrench-guide-cloud-state-diagram.png" alt="wrench-guide-cloud-state-diagram.png"/>
</div>
<p> <br />
</p>
<h1><a class="anchor" id="guide-cloud-using"></a>
Submitting Jobs to a cloud compute service</h1>
<p>As expected, a cloud service provides implementations of the methods in the <code><a class="el" href="classwrench_1_1_compute_service.html" title="The compute service base class. ">wrench::ComputeService</a></code> base class. The <code><a class="el" href="classwrench_1_1_compute_service.html#abc9e51234c29965341727f07b446ff0c" title="Submit a job to the compute service. ">wrench::ComputeService::submitJob()</a></code> method takes as argument service-specific arguments as a <code>std::map&lt;std::string, std::string&gt;</code> of key-value pairs. For a cloud service, these arguments are optional and to be specified as follows:</p>
<ul>
<li>key: <code>-vm</code>; value: a VM name (as returned by <a class="el" href="classwrench_1_1_cloud_service.html#a6e614c2edbe303de83a47c024e84e250" title="Create a BareMetalComputeService VM (balances load on execution hosts) ">wrench::CloudService::createVM</a>) on which the job will be executed.</li>
</ul>
<p>If no argument is specified, the cloud service will pick the VM on which to execute the job.</p>
<p>Here is an example job submission to the cloud service:</p>
<div class="fragment"><div class="line"><span class="comment">// Create a VM with 2 cores and 1 GiB of RAM</span></div><div class="line"><span class="keyword">auto</span> vm1 = cloud_cs-&gt;createVM(2, pow(2,30));</div><div class="line"><span class="comment">// Create a VM with 4 cores and 2 GiB of RAM</span></div><div class="line"><span class="keyword">auto</span> vm2 = cloud_cs-&gt;createVM(4, pow(2,31));</div><div class="line"></div><div class="line"><span class="comment">// Create a job manager</span></div><div class="line"><span class="keyword">auto</span> job_manager = this-&gt;createJobManager();</div><div class="line"></div><div class="line"><span class="comment">// Create a job</span></div><div class="line"><span class="keyword">auto</span> job = job_manager-&gt;createStandardJob(tasks, {});</div><div class="line"></div><div class="line"><span class="comment">// Create service-specific arguments so that the job will run on the second vm</span></div><div class="line">std::map&lt;std::string, std::string&gt; service_specific_args;</div><div class="line">service_specific_args[<span class="stringliteral">&quot;-vm&quot;</span>] = vm2;</div><div class="line"></div><div class="line"><span class="comment">// Submit the job</span></div><div class="line">job_manager-&gt;submitJob(job, cloud_cs, service_specific_args);</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/>
<address class="footer">
    <small>
        Generated by &#160;<a href="http://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.png" alt="doxygen"/>
    </a> 1.8.11
    </small>
</address>
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-18066333-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
<script type="text/javascript" src="doxy-boot.js"></script>
</html>
